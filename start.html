<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Upload and analyze student assignments with AI-powered evaluation. Get instant plagiarism, accuracy, and writing scores.">
  <title>Start Analyzing ‚Äî AnalytixAI</title>
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="opacity: 0;">
  <script>document.body.style.transition = 'opacity 0.4s ease';</script>

  <div id="navbar-root"></div>

  <!-- Loader Overlay -->
  <div class="loader-overlay" id="loader-overlay">
    <div class="spinner"></div>
    <p class="loader-text">Analyzing assignment...</p>
  </div>

  <!-- Upload Section -->
  <section class="upload-section">
    <div class="glass-card upload-card reveal-up">
      <!-- Message -->
      <div class="message" id="upload-message"></div>

      <!-- Section Selector -->
      <div class="form-group" style="margin-bottom: 24px;">
        <label for="section-select" style="font-weight: 700; color: var(--color-gray-900);">Select Section</label>
        <select id="section-select" class="form-select" required>
          <option value="">Loading sections...</option>
        </select>
      </div>

      <!-- Rubric Weightage Section -->
      <div class="rubric-section" style="margin-bottom: 24px; padding: 20px; background: rgba(99, 102, 241, 0.03); border-radius: 16px; border: 1px solid rgba(99, 102, 241, 0.1);">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
          <div style="display: flex; align-items: center; gap: 8px;">
            <input type="checkbox" id="rubric-toggle" style="width: 18px; height: 18px; cursor: pointer;">
            <label for="rubric-toggle" style="font-weight: 700; cursor: pointer; color: var(--color-gray-900);">Customize Rubric Weightage</label>
          </div>
          <div id="rubric-total-badge" style="display: none; background: var(--color-gray-100); color: var(--color-gray-600); font-size: 0.75rem; font-weight: 700; padding: 4px 10px; border-radius: 20px; border: 1px solid var(--color-gray-200);">
            Total: <span id="rubric-total">100</span>%
          </div>
        </div>

        <div id="rubric-content-area" style="display: none;">
          <p style="font-size: 0.82rem; color: var(--color-gray-500); margin-bottom: 16px;">Define how much each category contributes to the final score (must sum to 100%).</p>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 12px;">
            <div class="weight-input-group">
              <label style="display: block; font-size: 0.75rem; font-weight: 600; color: var(--color-gray-600); margin-bottom: 4px;">Relevance</label>
              <input type="number" id="weight-relevance" class="form-input weight-input" value="20" min="0" max="100" style="padding: 8px 12px; font-size: 0.88rem;">
            </div>
            <div class="weight-input-group">
              <label style="display: block; font-size: 0.75rem; font-weight: 600; color: var(--color-gray-600); margin-bottom: 4px;">Understanding</label>
              <input type="number" id="weight-understanding" class="form-input weight-input" value="30" min="0" max="100" style="padding: 8px 12px; font-size: 0.88rem;">
            </div>
            <div class="weight-input-group">
              <label style="display: block; font-size: 0.75rem; font-weight: 600; color: var(--color-gray-600); margin-bottom: 4px;">Logic</label>
              <input type="number" id="weight-logic" class="form-input weight-input" value="20" min="0" max="100" style="padding: 8px 12px; font-size: 0.88rem;">
            </div>
            <div class="weight-input-group">
              <label style="display: block; font-size: 0.75rem; font-weight: 600; color: var(--color-gray-600); margin-bottom: 4px;">Structure</label>
              <input type="number" id="weight-structure" class="form-input weight-input" value="15" min="0" max="100" style="padding: 8px 12px; font-size: 0.88rem;">
            </div>
            <div class="weight-input-group">
              <label style="display: block; font-size: 0.75rem; font-weight: 600; color: var(--color-gray-600); margin-bottom: 4px;">Clarity</label>
              <input type="number" id="weight-clarity" class="form-input weight-input" value="15" min="0" max="100" style="padding: 8px 12px; font-size: 0.88rem;">
            </div>
          </div>
        </div>
      </div>

      <hr style="border: none; border-top: 1px solid var(--color-gray-100); margin-bottom: 24px;">

      <!-- Reference Answer Section -->
      <div class="reference-section" style="margin-bottom: 24px; padding: 20px; background: rgba(0,0,0,0.02); border-radius: 16px; border: 1px solid var(--color-gray-100);">
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px;">
          <div style="display: flex; align-items: center; gap: 8px;">
            <input type="checkbox" id="ref-toggle" style="width: 18px; height: 18px; cursor: pointer;">
            <label for="ref-toggle" style="font-weight: 700; cursor: pointer; color: var(--color-gray-900);">Add Reference Answer (Best Practice)</label>
          </div>
          <div id="ref-mode-toggle" style="display: none; background: var(--color-gray-100); border-radius: 10px; padding: 4px; border: 1px solid var(--color-gray-200);">
            <button class="btn-ref-mode active" data-mode="file" style="font-size: 0.75rem; padding: 6px 16px; border-radius: 8px; border: none; background: var(--color-primary); color: white; cursor: pointer; font-weight: 600; transition: all 0.2s;">File</button>
            <button class="btn-ref-mode" data-mode="text" style="font-size: 0.75rem; padding: 6px 16px; border-radius: 8px; border: none; background: transparent; color: var(--color-gray-600); cursor: pointer; font-weight: 600; transition: all 0.2s;">Text</button>
          </div>
        </div>

        <div id="ref-content-area" style="display: none;">
          <div id="ref-file-container">
            <div class="drop-zone" id="ref-drop-zone" style="padding: 32px 20px; background: white; border: 2px dashed var(--color-gray-300); border-radius: var(--radius-md);">
              <div class="drop-zone-icon" style="font-size: 1.8rem; margin-bottom: 8px;">üìù</div>
              <p class="drop-zone-text" style="font-size: 0.9rem;">Drop <strong>Reference PDF/DOCX</strong> here</p>
            </div>
            <input type="file" id="ref-file-input" accept=".pdf,.docx,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document" hidden>
            <div class="file-info" id="ref-file-info" style="display:none; margin-top: 12px; background: white;">
              <span>üìé</span>
              <span class="file-name" id="ref-file-name" style="font-size: 0.8rem;"></span>
              <button class="file-remove" id="ref-file-remove">‚úï</button>
            </div>
          </div>
          <div id="ref-text-container" style="display: none;">
            <textarea id="ref-text-input" placeholder="Paste the correct answer or key points here..." style="width: 100%; height: 140px; padding: 16px; border-radius: var(--radius-md); border: 2px dashed var(--color-gray-300); background: white; transition: all var(--transition-base); font-family: inherit; font-size: 0.9rem; resize: vertical;"></textarea>
          </div>
        </div>
      </div>

      <hr style="border: none; border-top: 1px solid var(--color-gray-100); margin-bottom: 24px;">

      <h3 style="font-size: 0.95rem; font-weight: 700; margin-bottom: 12px; color: var(--color-gray-700);">Upload Student Assignment</h3>

      <!-- Drop Zone -->
      <div class="drop-zone" id="drop-zone">
        <div class="drop-zone-icon">üìÑ</div>
        <p class="drop-zone-text"><strong>Click to upload</strong> or drag and drop</p>
        <p class="drop-zone-hint">PDF or DOCX ¬∑ Max 5MB</p>
      </div>
      <input type="file" id="file-input" accept=".pdf,.docx,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document" hidden>

      <!-- File Info -->
      <div class="file-info" id="file-info" style="display:none; margin-bottom: 20px;">
        <span>üìé</span>
        <span class="file-name" id="file-name"></span>
        <span class="file-size" id="file-size"></span>
        <button class="file-remove" id="file-remove">‚úï</button>
      </div>

      <!-- Analyze Button -->
      <button class="btn btn-primary btn-lg" id="analyze-btn" disabled style="margin-top:24px; width:100%;">Analyze Assignment</button>

      <div class="results-section" id="results-section" style="display:none;"></div>
    </div>
  </section>

  <div id="footer-root"></div>

  <script src="js/config.js?v=2"></script>
  <script src="js/auth.js?v=2"></script>
  <script src="js/components.js?v=2"></script>
  <script src="js/upload.js?v=2"></script>
  <script src="js/animations.js?v=2"></script>
</body>
</html>
