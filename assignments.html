<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Manage and view assignment groups within your sections.">
  <title>Assignments â€” AnalytixAI</title>
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body style="opacity: 0;">
  <script>document.body.style.transition = 'opacity 0.4s ease';</script>

  <div id="navbar-root"></div>

  <section class="sections-section">
    <div class="container">

      <div class="sections-header reveal-up">
        <div>
          <h1 id="section-name-header">Loading Section...</h1>
          <p id="section-desc-header">View all assignments given to this class.</p>
        </div>
        <div style="display: flex; gap: 12px;">
          <button class="btn btn-secondary" id="create-task-btn">+ Create Assignment Task</button>
          <a id="start-btn-link" href="start" class="btn btn-primary">Manual Upload</a>
        </div>
      </div>

      <!-- Empty State -->
      <div id="assignments-empty" class="no-data" style="display: none;">
        <div class="no-data-icon">ðŸ“‚</div>
        <h2>No Assignments Yet</h2>
        <p>Start by uploading student assignments for this section.</p>
      </div>

      <!-- Assignments Grid -->
      <div id="assignments-grid" class="sections-grid">
        <!-- Task cards injected here -->
      </div>

    </div>
  </section>

  <!-- Create Task Modal -->
  <div class="modal-overlay" id="task-modal">
    <div class="glass-card modal-card" style="max-width: 550px; padding: 24px;">
      <h2 style="margin-bottom: 4px;">Create Assignment Task</h2>
      <p style="font-size: 0.8rem; color: var(--color-gray-500); margin-bottom: 16px;">
        Generate a unique link for student submissions.
      </p>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
        <div class="form-group" style="margin-bottom: 0;">
          <label for="task-title" style="font-size: 0.75rem;">Assignment Title</label>
          <input type="text" id="task-title" class="form-input" placeholder="e.g. Midterm Essay" required style="padding: 8px 12px; font-size: 0.85rem;">
        </div>
        <div class="form-group" style="margin-bottom: 0;">
          <label for="task-desc" style="font-size: 0.75rem;">Short Instructions</label>
          <input type="text" id="task-desc" class="form-input" placeholder="What should students do?" style="padding: 8px 12px; font-size: 0.85rem;">
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr; gap: 12px; margin-bottom: 16px;">
        <!-- Rubric Settings -->
        <div class="rubric-section" style="padding: 12px 16px; background: rgba(99, 102, 241, 0.03); border-radius: 12px; border: 1px solid rgba(99, 102, 241, 0.1);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
            <div style="display: flex; align-items: center; gap: 6px;">
              <input type="checkbox" id="rubric-toggle" style="width: 16px; height: 16px; cursor: pointer;">
              <label for="rubric-toggle" style="font-size: 0.8rem; font-weight: 700; cursor: pointer; color: var(--color-gray-900);">Custom Rubric Weights</label>
            </div>
            <div id="rubric-total-badge" style="display: none; background: var(--color-gray-100); color: var(--color-gray-600); font-size: 0.65rem; font-weight: 700; padding: 2px 8px; border-radius: 10px; border: 1px solid var(--color-gray-200);">
              Total: <span id="rubric-total">100</span>%
            </div>
          </div>

          <div id="rubric-content-area" style="display: none;">
            <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px;">
              <div class="weight-input-group">
                <label style="display: block; font-size: 0.6rem; color: var(--color-gray-500);">Rel.</label>
                <input type="number" id="weight-relevance" class="form-input weight-input" value="20" style="padding: 4px; font-size: 0.75rem; text-align: center;">
              </div>
              <div class="weight-input-group">
                <label style="display: block; font-size: 0.6rem; color: var(--color-gray-500);">Und.</label>
                <input type="number" id="weight-understanding" class="form-input weight-input" value="30" style="padding: 4px; font-size: 0.75rem; text-align: center;">
              </div>
              <div class="weight-input-group">
                <label style="display: block; font-size: 0.6rem; color: var(--color-gray-500);">Log.</label>
                <input type="number" id="weight-logic" class="form-input weight-input" value="20" style="padding: 4px; font-size: 0.75rem; text-align: center;">
              </div>
              <div class="weight-input-group">
                <label style="display: block; font-size: 0.6rem; color: var(--color-gray-500);">Str.</label>
                <input type="number" id="weight-structure" class="form-input weight-input" value="15" style="padding: 4px; font-size: 0.75rem; text-align: center;">
              </div>
              <div class="weight-input-group">
                <label style="display: block; font-size: 0.6rem; color: var(--color-gray-500);">Cla.</label>
                <input type="number" id="weight-clarity" class="form-input weight-input" value="15" style="padding: 4px; font-size: 0.75rem; text-align: center;">
              </div>
            </div>
          </div>
        </div>

        <!-- Reference Material -->
        <div class="reference-section" style="padding: 12px 16px; background: rgba(0,0,0,0.02); border-radius: 12px; border: 1px solid var(--color-gray-100);">
          <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
            <div style="display: flex; align-items: center; gap: 6px;">
              <input type="checkbox" id="ref-toggle" style="width: 16px; height: 16px; cursor: pointer;">
              <label for="ref-toggle" style="font-size: 0.8rem; font-weight: 700; cursor: pointer; color: var(--color-gray-900);">Add Reference Context</label>
            </div>
            <div id="ref-mode-toggle" style="display: none; background: var(--color-gray-100); border-radius: 8px; padding: 2px;">
              <button class="btn-ref-mode active" data-mode="text" style="font-size: 0.65rem; padding: 4px 10px; border-radius: 6px;">Text</button>
              <button class="btn-ref-mode" data-mode="file" style="font-size: 0.65rem; padding: 4px 10px; border-radius: 6px;">File</button>
            </div>
          </div>

          <div id="ref-content-area" style="display: none;">
            <div id="ref-text-container">
              <textarea id="ref-text-input" placeholder="Paste ground truth content..." style="width: 100%; height: 60px; padding: 8px; font-size: 0.75rem; border: 2px dashed var(--color-gray-300);"></textarea>
            </div>
            <div id="ref-file-container" style="display: none;">
              <div class="drop-zone" id="ref-drop-zone" style="padding: 12px; border: 2px dashed var(--color-gray-300);">
                <p style="font-size: 0.75rem;">Drop <strong>PDF/DOCX</strong> here</p>
              </div>
              <input type="file" id="ref-file-input" accept=".pdf,.docx" hidden>
              <div class="file-info" id="ref-file-info" style="display:none; margin-top: 8px; padding: 6px;">
                <span class="file-name" id="ref-file-name" style="font-size: 0.7rem;"></span>
                <button class="file-remove" id="ref-file-remove">âœ•</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-actions">
        <button class="btn btn-secondary" id="cancel-task-modal">Cancel</button>
        <button class="btn btn-primary" id="save-task-btn">Create Task</button>
      </div>
    </div>
  </div>

  <!-- Share Modal -->
  <div class="modal-overlay" id="share-modal">
    <div class="glass-card modal-card" style="text-align: center;">
      <div style="font-size: 2.5rem; margin-bottom: 16px;">ðŸ”—</div>
      <h2>Share Assignment Link</h2>
      <p style="color: var(--color-gray-500); margin-bottom: 24px;">Send this link to your students. They can upload their files directly.</p>
      
      <div style="display: flex; gap: 8px; margin-bottom: 24px;">
        <input type="text" id="share-link-input" class="form-input" readonly style="flex: 1; text-align: center;">
        <button class="btn btn-primary" id="copy-link-btn" style="padding: 0 20px;">Copy</button>
      </div>

      <button class="btn btn-secondary" style="width: 100%;" onclick="document.getElementById('share-modal').classList.remove('active')">Done</button>
    </div>
  </div>

  <div id="footer-root"></div>

  <script src="js/config.js?v=2"></script>
  <script src="js/auth.js?v=2"></script>
  <script src="js/components.js?v=2"></script>
  <script src="js/assignments.js?v=2"></script>
  <script src="js/animations.js?v=2"></script>
</body>
</html>
